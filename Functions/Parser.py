# File to read, parse and get everything in an easy to paste in google docs kinda way

import os
import sys
import subprocess
import csv
import pathlib

import Functions.ParsingFunctions as ParsingFunctions


def main(party_usernames: list, name, sar_timeseries_userlist: list = None):
    if sar_timeseries_userlist is None:
        sar_timeseries_userlist = []

    # Files that have -sar.txt in the name are useful to us
    # We can get the username from the dict and parse those files

    # and $user.txt and $user-synced.txt files are the str reps of the dict so we can easily parse those

    output_dir = f"Outputs/CSVs/{name}/"
    
    # Create the directory for storing all the data
    try:
        pathlib.Path(output_dir).mkdir(parents=True)
    except FileExistsError:
        makenew = True
    else:
        makenew = False
    # We have the files, now its just a matter of opening and writing everything

    for user in party_usernames:
        sar_file = f"{user}-sar.txt"
        eval_file = f"{user}.txt"
        eval_postsync_file = f"{user}-synced.txt"
        success = True
        

        try:
            with open("Outputs/SAR/" + sar_file) as f:
                ...
            if user == "user":
                ...
            else:
                with open("Outputs/Evaluations/" + eval_file) as f:
                    ...
                with open("Outputs/Evaluations/" + eval_postsync_file) as f:
                    ...
        except FileNotFoundError:
            success = False
        else:
            if user != "user":
                subprocess.run(f"mv Outputs/{user}-epoch-logs.csv {output_dir}{user}-epoch-logs.csv", shell=True)
                with open("Outputs/Evaluations/" + eval_file) as f:
                    loss, accuracy, params = ParsingFunctions.model_performance(
                        eval(f.read().strip())
                    )
                with open("Outputs/Evaluations/" + eval_postsync_file) as f:
                    postsync_accuracy = eval(f.read().strip())["accuracy"]
            try:
                averages, timeseries = ParsingFunctions.get_sar_data_pi(
                    "Outputs/SAR/" + sar_file
                )
            except Exception:
                print(f"Unable to parse SAR data for {user}")
                print(
                    f"{user} File Parse Status : {'Successful' if success else 'Unsuccessful'} with Failed SAR Parse"
                )
                continue
            CPU, MEM, DISK, NET = averages

            if user != "user":
                format = (
                    user,
                    loss,
                    accuracy,
                    " ",
                    " ",
                    CPU[r"%user"],
                    MEM[r"%memused"],
                    " ",
                    " ",
                    NET[r"rxpck/s"],
                    DISK[r"rkB/s"],
                    DISK[r"wkB/s"],
                    NET[r"txpck/s"],
                    *params,
                    postsync_accuracy,
                )

                # Wipe the file
                if makenew:
                    with open(output_dir + "Parties.csv", "w", newline="") as _:
                        ...

                with open(output_dir + "Parties.csv", "a", newline="") as f:
                    writer = csv.writer(f)
                    writer.writerow(format)

            if user in sar_timeseries_userlist:
                # Parse Timeseries Data and write it to the file
                power = ParsingFunctions.get_power_data("Outputs/Power/Data.pkl")
                for datapoint in timeseries:
                    timestamp, values = datapoint
                    current, voltage, pwr_in_watts = (" ", " ", " ")
                    if timestamp.strip() in power.keys():
                        data = power[timestamp.strip()]
                        current = data["current"]
                        voltage = data["voltage"]
                        pwr_in_watts = data["power"]

                    CPU, MEM, DISK, NET = values

                    # Wipe the file
                    if makenew:
                        with open(output_dir + f"{user}-SAR.csv", "w", newline="") as _:
                            ...
                    with open(output_dir + f"{user}-SAR.csv", "a", newline="") as f:
                        writer = csv.writer(f)
                        format = (
                            timestamp,
                            CPU[r"%user"],
                            MEM[r"%memused"],
                            NET[r"rxpck/s"],
                            NET[r"txpck/s"],
                            DISK[r"rkB/s"],
                            DISK[r"wkB/s"],
                            current,
                            voltage,
                            pwr_in_watts,
                        )
                        writer.writerow(format)

        finally:
            print(
                f"{user} File Parse Status : {'Successful' if success else 'Unsuccessful'}"
            )


"""
@@@@@@@@@@@@@@%*++++*%%%%%%%%@@@@@@@@%%@%#%%@@##########*+=##%%%##***%%########*+*###****###%%#%%%#**#**##*++*+**+*****+==+#####*+***++**#%#****++#%*+-------========================-==================+
@@@@@@@@@@@@@%****##*+%%%%%%%%%%%%%@@@@@@@%#@@######*###=+**##****+*%@%#%%#####****#%#+*#**###%%##***######*+*###***#%%#####**##+=++*+=+*##+*#*+*=*%%+=-====================------=================+**###
@@@@@@@@@@@@%##++%%##+=%%%%%%#######%%%@@@%%@@#########**#*++=+++*####%%%%#####*==*#%#*******####%%%%%%%%#***###**#%%%%%%#*+*###*=-=+***####%#*#%**#%#=-================----================+++++++=--:::
@@@@@@@@@@@%##**#%%#**=+%%#*******####%%%%@@@@%###*****#%#++++=*#%%%%%%#*=+****=++*++####*+*##%%%%%%%%%%%##**=*%%@@@@@%%##**+*%###+=+*#%%%%%%##%%%#%##*=============--====++================+*##+-:::::::
@%%@@@@@@@%#####*%%**++-*#************####%%@%#***++++=*+**+==+####%#*#*+-*==++-****%###*+*#%%%%%######%%%%%%##@@@@@%%%%%%#**%%####*=*%%%%%%%%%%@#+*###*=======---========================+*##+-::::.::::
%@@@@@@@%%%####+=*#*++++-++++***+++***##########*++*#%%*++===+**#%%#+=**=++=-==**=+#%#*==*#%#########%%%@@@%%@@@@@%%%%%%%%##%%#**###*#%%@@%%%%%%%%#++##*====-===========================+*#%#=:::::....::
@@@@%%%%%###*##*++**++*#--==++****++*######**###+*=*#*==+==+*+#%%%%*+*#*++==++=+==**+===+*#####***###%%%%%@%%@@%%%%@%%%%%%%%%%%*%%#*#%%@@%%%%%%%%%%***##=-=============================+*#%*=-:::::-=**#*
@%%%%%%####****#****++##*:-==+*#####%%@@%%#####==+*%##+==--=*#%%%%%++##**==++-====+#*+==*##*+++++++**###%%%%%%%%@%%%%%%%%%%%%%%%%%###%@@@%%%%%%%%%%##*#*===============================+*%#=---=+#*+++=-:
%%%%#######****#+=*******+:===+#%%###%%@@%####+-=+**#*++-=###%%#%%*=*#++=+**+++*==++#**#%#***+++##%#####%%%%%%%%%%%%@%@%%%%%%%%%%%#*##%%%%%%%%%%#%###*%#===============================+**+=*###***+-----
###########****#*-+*******=:-==*#%@%###%######%@%**+*++=+***%**%%#**#+-=+##+##+++-=+*+*%##*+***#######%%%%%%%%%%%%%%@%%%%%@%%%%######%%%%%%%%%%%##%%%#%#+=============================+*###%%%###++=--:-=
**##****###**####=:*******=:::=*###***#%%%#####*+*+=++*#*=***=#%%*#*==+#%#*##+++---==+*##*++**######*#%%%%%%%%%%%%%@@@@@@@@%%%%%%%%%%%%%%%%%@@%%%%%%%%%#+============================+*%%%%%%##+==----=**
%**##****########+:+###***---::-+#*+++#####******+++***#=**+-+%%#*++*%%%#*###+**+==-=*##**+*++*****####%%%%%%%%%%@@@%%%%%%%%%@@%%%%%%%%@%%@@@@@%%%%@%%%#*+=========================+#%%%@%%%##****++++**#
###*****########+---=+****-:------=+++*####**###**=*#%#***+==*%%#**%%##%%###*+***+===+*++****#%##%%%%%%%%%%%%%%%%%%%%%%%%%%%@@%%@@@%%%@@@@@@@@@@@@@%%%%#*+========================+#%%@%%###**##*=====+*+
*******#######%#=:-:::-=+=-:-------=+=+**##+###%#++#%%##**+==#%**%%%#%%%%%##++***+=-==-=*#%#####%%%%#%%%@@@@@@@@@@@@@@@@@%%%%%%%@@@@@@@@@@@@@@@@@@%%%@%#*+======================+#%@%###%%%%%%%#******##%
%###**###%@%%%%+----::-----:--------=*###*+*##%#*=+#%###***+*%%%%%%%%%%%@%#*#+**++==-=+#%%##**#%%%%%#%%@%%@@@@@@@@@@@@@%%%##%%%%%@@@@@@@@@@@%@@%%%%%@%%#*+=====================*#%#*###%##%#*++++*++++*##
+*#%###%%%%%@@%=-==-:------:::-----=*###*+*%#%@#==*###**##%**###*#%#%%@%%###%#*****+*####*++*#######%%%@@@@@@@@@%%%%%%%%%%##%%%%%%@@@@@@@@@@@@@@@%%%%%%#*+==+===============+++**+***+*#***++++****#**+*#
==++##%%%@@@@@#-===---==-=--::----=*####++%%%@%%*+++*+=*##%***#+##*%%%@%##%###*#***#%*++====+*####%%%%%%%%%@@@@%%%%%%%%%%%%%#%%@@%%@@@@@@@@@@@@@@@%%%%%#*=++++=========+++++==+====++=---+*++==**#%%%##**
===+++%@%@@@@@#++===-==--==------=####**+*%%%@@%*+=++*%##%#*++*#%#%%%@@%%%%%#######*++++==+###%%###%%%%%%#%%%%%%%%%%%%%%%%%%%%%@@%#@@@@@@@@%%@@%%%%%%%%%*=+==============++=---=**++++=-==+**#%%@@@@%%%##
++====+*#%@%%@@%#*+#+====----=---*#####*+#%%%%#+*+=+##%%#%#+=*###%%%%%%%%%%%%####**+++*#%@@%*#%#####%%##%%%%%%%%%%%%%%%%%%%%%%%%%#*%@@@@@@@@@@%%%%%%%%%%#===========+++++==++====++*#*++==*#%%@@@@@%%%###
*++===++=+*#%@@%*%%%*=====---==+#%%##%##*#%##*****+=*%###*+=+##%%%%%%@%%*#%%%##*++++####%%**%%#*+++*##*##%%%%%%%%%%%%%@@@@%%%%%%%%#%@@@@@%%%%%%%@@%%%%%%#+++++=++++++====+*#+-=+****+++++*@%@@@@@@%%####+
++++===++=+*#%@@@@@@%**+*+++**#%%#%%%%####******##++*%%%*++**#%%%%%@%%%%#%%##++**########*##**+====+***##%%%%%%%%%%%@@@@%%%%%%%%%%#%@@@@@@@@@@@@@%%#%%%%%++++++++++====++*##+=+#%%%%*+*#%@%%%@@@%%######*
=++++===+++++#%@@@@@@%%@%%%%%%%%%%%%%%###*+++#**##++***+++*##%%%%%@@@%%%%%#########**********+-=-=*#*####%%%%%%%%%%%%%@@%#%%%%%%%%%%@@@@@@@@@@@@@%##%%%%#++++++=+++++===*###***%@%@@@%*#%@@@@@%%%##%%#***
+=+++++==+++++*%%@@@@%%%%%%%%%%%%##*#%%##*+*##+*##**+*===+*#%%##%@@@%%%%%####*##*++==+*%#*+++===+*%#*++#%%%##%%##%%%%%%%##%##%%%%%%%@@@@@@@@@@@@@%##%%@%*++++++++======+*###*+*#%@@@%@@@@@@@@@%##%%%#***#
=+==++++===+++++%%%@@%%%%%%%%%%%%##*#%#***##########*+==*%%@%*#%@@@%###%#*###**+++*###%*++=-==++*#*#%#%%%###%#+**#%%#+*#####%%%#%%%%@@@@%%@@@@@@@#*#%@@%+++++==++++++==+*#%%#**%%%@@@@@@@@@@%%##%%%##***#
.=++++++++==++++*%%@@@%%%%%%%%%%%%%%%%##*#**%%#####***##%%#*+*%@@%***#%*++=+#***######+++++++*##%%%%#%%*=+%#*==**##*+=+*##%#%%%%%%%%@@@%%%%@@@@@%#*#%%%#++++++++++++++++*#%####%%%@@@@@@@@@%%%%%%%%#####%
.:++++++++++++++++%%@@%%%%%%%%%%%%%########*######%%%#%%%#==+#@@%*=+#%#**==***###%%%%*++**+*#%%%@@%%#+=+#%%#*+*##+==--==+*###%%%%%%@@%%%%%@@@@@%%##%%%%*++++++++++++++++*#%%%%%%@%%@@%%@@@@%%%%%%%%%%##%%
:.:***+++*+++++++++#@@@#%%%%%%%%%%#*###########%%%%%%%%#*+*##%#+=-=*%@%#+=**+**#%%##*+=+***%%%%%%%#+=+#@@%#**####*+==++-==*###%%%#%@@@@%%@@@@@%@%*#%@%%*++++++++++++++++*#%%%#%@@%@@@%%@@@%%#%%%%%@@%%%%%
::.-********+++++++*#@@#=#%%%%%%%%%####**#%###%%%%%%@%###%%##+-==+#%@@%*##**%@@@%%*===+#%%%%%##%%#**#@@@@%%#%%%%%####*+==+##*%%%##@@@@@%@@@@%%%%#*#%@%%*+++++++++++++++++*%%##%@@@@@@@@@@@%%%%%%%%@@%%##%
:...=********++++++++#@@#:=%%%%%%%%#%%#**#%###%%%%%%%###%%##*+*#%%%%@%#%%*#%%@%##***+*#@@%%%%##%*#%%%@@@%%%%%%%%%%%##**+*#%**#%%%@@@@@%%@@@@%@@%#*#%@%#++++++++++++====++*%%##%%@@@@@@@@@@%%%%%%%%@%%%##%
:..:+#********++++++++#@%#:+%%%%%%%#@@%#*##%%#%@%@%%%##%%%%**#%%%#%@%%%%#%@@%@%*######%@@%%%%%%%%%%%@@@%%%%%%%%%%%##**##%%%*##%@@@@@@%@@@@@@%@@#*#%@@%#*++++++======++++**#%%##%@@@@@@@@@@%%%%%%@@%%%%%%%
::.:####************+++###+-#%%%%%%%@@@%#%%%%%%%%%%%%%%@%%%##%%@@@@@%%%%%%@%@@@##%%##%%@@%%%%%@@%%%@@%##%%%%%%%%##**###%%%##*%%%@@@@@@@@@@@@%@%**%@@@%*++++===++++++***####%%%%%@@@@@@@@@%%%%%@@@%%%%%%%%
::..+%###************++*%####%%%%%%%@@@@%%%@%####%%%%%@@%##%%%%@@@@@@@@@@@@@@%##%%%%%@@@%%%%%@@@@@%@@%#%%%%%%%#########%%%###%@@%%%%%@@@@@@%%%###@@%%#+==---::--+*#%%%###**%@@%%@@@@@@@@@%%%%%%@@%%%%%%%%
:::..*%#######*******+++#%*#@*%%%%%%@@@@%%%%%%%#*#%%%@%%##%%%%@@@@@%%@@%%@@@%***##%%%@@@%##%@@@@@%%@@%%@@%%%%%%%%%#####%##%%@@@@@@@@@@@@@@@@%%%%@%#*+==------==-:=***++==++#@@%%%@@@@@@@@@@%%%%@@@%%%%%%%
::::::*########******+*++#**###%%%%%@@@@@@@@@@%##%%%%%%#*#%##%@@@@@%%%@%%@@@%%###%%#%%@@%#%%@%@@@@@@@@@@%%%%##%@@%%%%##%#%%@@@@@@@@@@@@@@@@@%%%%%%*+=-----=======--=+++****#%@@%@@@@@@@@@@@@%%%%@@@%@%%%%
.::::.:########*********+*#***%%%%%%@@@@@@@@@@%%%%%%@@%*#%%*%@%@@@@%###%@@@%%%%#%%%%@@@%%#%%@@@@@@@@@@@@@%%%%%@%%%%%%%###%%@@@@@@@@@@@@@@@@%%%%%%#*==--===========--+****##%#%@@@@@@@%@@@@@@@%%%%%%@@@%%%
...:::.:########********++##*+*%@@%%%@@@%@@@@@@@%%%%@@##%@*#@%@@@@%#*##%%@%####%@@@@@%%%%#%@@@@@@@@@@@@@@%%@%%%@@%%%%%####%%@@@@@@@@@@@@@@%%@%%%%*================--+**####%##%@@@@@@%#%@@@@@@%%@@@@@@@%%
........+########**********##**#%@%%%@@@%@@@@@@@@%%#@@#*%%=#%%@@@@#***###%%%%%%%%%@@%#*+###%@@@@@@@@@@%%%%@%%%@@@@%%%%#*###%%@@@@@@@@@@@@@@@@%%%#++++====-==========***####+++*#@@@@@%%%%@@@@@%%@@%@@@@@@
........-#########**********##*#%%%%%%%@@@@@@@@@@%#*%@**%#=#%%@@@@#***##**##%%%%@@@%#*++*#*#%%%@@@%%%@@@@@@@%%@@@%%%%#****#%%%%%%@@@@@@@@@@@@%%#*+++=====---======-+#####%*-=++#%%@@@@@%*#%%%@@@@@%@@@@%%
........:*########**********%#**%%%%%%%%@@@%@@@@@%*+#@%*%#=#%%@@@@#***#**+*#%%%@@@@@%##***#*%%%#%%@@@@@@@@@@@%%@@%%%%#+****%%###%%@@@@%@@@@@%%%*+=======----=======*######+--=+###%@@@@+---+#%@@@@@@@@@@@
........:+##########*********%**#%%%%%%%%%%@@@@@@@%**%@###=*%%@@%%#***#*+++*#%@@@%%%%#####%%@@@@@@@@@@@@@@@@@%%@@%%%#+++++*##**###%%%#%%@@@@%%#***+++===-----=====+###=*##+--=+#%%%%%%%#**=--+%@@@@@@@@@@
.........=%##########********##**#%%%@@@%%@@@%%%@@%%*#@@%%++##%@@%#***#*++++*%%%%@%***####%%@@@@@@@@@@@@@@@@@%%@%#%%*+++++*##*****#####%@@@%%#*+**+++++===---====+###%%%%%*=--=*######*++*++=-=#@@@@@@@@@
.........-#%%##########**++**###**%@@@%%%%%%@%%%%%@%%##@@@%+*##%@%%#**#*++++*%%*##%%%#####%%@@@@@@@@@@@@@@@@@@@%#%%#*++++++*#*++***+++*#@@%%##*++++=+++++=---===+*#####%%%#+====++**+++===+*+==+%@@@@@@@%
......:::=%%%%%%%%%%%####**++++#%#*%%%%%%%%#%%@%%%%%%#*#%@@%***##%@@%*#*+=++*%#+***##%%###%%%%%%@@@@@@@@@@@@@@@@%%#*+++++++*#*++++++==+#%@@##*==+=====+++=--==-=**####%%%%%%+=--==++=======**+++#@@@@@%%%
..::::::-#@%%%%%%%%%%%#%%%#####**#*#%%%%%%##**#@@%%##%%#*#%@@%%%%#%%@%%%#+***%#+++++***###%%%%%%%%%@@@@@@@@@@@@@%**++=+++++*#**++++===+*%@%##+========+++=-==--+*##%#%%@@@@@%+=-======---==+++=*#@@@@@%%%
:::::::-#@%%%%%%%#####%%%%%%%##***####*=:.....:=%@@*===+*#########%%%%%%@%##*%#===++++*****#%%%###%#%%%@@@@%%%%#*+++++**###***+========*%%###+=-=====+++=-===-+###**%%%%%%%%@#+--=====---==-==+*#@@@@@@%%
::::::-***###****+**##%##**++==+**##%%%###########%%+==------========+++*#*++##+==+===++=+++*#%#**+*********++++***###%%##*+++========+%%##%#========++--==--=*###*#%%%##%%%%@%+==========----=+#@@@@@%%%
:::::::*#*+*****+====++=-:..:+#%%%###*++++++***##=+%*=----------------==-=++=+#%**+==++======+***+++=====+=++++*#%%%%##*+++==========+%%####*=======+=-===--=***#%%%@@@%#%%%%%%%+=========--:-+###@%%%%##
............::::::........:*%%%%#*+=-----:--====+=-+#=---------------------=++*##*++===========+=========++**##%%%#*+++=============+%%#####*=+*+==--====--=*###%%###%%##%%%%%%%#+=====++=--+*++#%%%%##**
:::::..:.::.............-*%%%%#*+=---=-----:-:---=-*#+----:------------------=+++=====================+**#%%%%%%*+=======+++++======#%##*+**+=++==--===---=*####%%%%##%%%%%%%%%%%%#+====+=++*######*#****
::::..::..:...........:#%@%%%#*+=+++*#*+++===-----+%%+=------------------------======--==========++**##%%%%%#*+======+++***++======#%##*==+*+=========---=######%%%%%%%##%%%%%%%%%%@#+==++++********+++*+
::::.:::..::.........-%@@@%%#****####%%###****#+--*##*+===---------------=-------------=======++*##%%%%%%#+======++++*****+=======++++*===+++=======----+#######%%%%###%%%%%%%%%%%@@@%+==+++*****+===++++
::..:::....:....::..=%@@@@%##*##%%%%#%%%#%#%%%%#++#%###**+++==================------=======+++**#%%%##*++++====+++*****++========#@%#+====+=+==---==---=#####%%%%#*#%##%%%%%%#==#%%#=::::==++****+=++++=+
:.::::...:::..:....=%@%#%%%####%%%%%%%%%%%%@@@@%#%@@+=*####****++++++++==================++**########***+++++++++**%#*++====+*#%%%%%#=====+=+==-------=#%%%%%%%%%##%%%%%%%%%%%%%@%=-:::::----==++++*++===
:::::.:::::::.:::.=@@@%##%%#%%%%%%%@@%@@@@@@@@@@%%@%=-====+*#%%%%%%%%%#**+++===========++**####%%%%@%%%#*+++++*%%%####%@@%%%%%%%%%%#========+==-----=*%########%%%%%%%%%@%%%%%%%%=:-----::::---:::-+==+++
::---------::::::-%@@@@%##@@%%%%%%%%%%@@@@@@@@@%#%@#++++========+++***#####**+++===+++++*****#####%%%%@%%%%%%%%%%%%###*+=====*%%%#==========+*+===+*##########%%%%%%%%%%%%%%%%%%=:::----:::--------=+++*#
------:::--::::::*@@@@@%#%@@@%%%%%%%%%%%%@@%%@@#*#@%#*+**+=========+++***#%%%%#**+=====++++**#########%%%%%##***++++=====-----=#%*==========*############**+*%@%%%%%%%%%%%%@@@%+-----:---::------:--+%%%%
--:--------:::::-#@@@@@@%@@%%%%#%%%%%%%%%@@@@@%**%@@%%#**+====++++++++*#%%%%%#*##*=======++++***#%%%%#**++++++***+====---------=#*==========*#####****++++++#@%%#=-----------==-------:------------=#%%%%
---------::::::::*@@@@@@@@@%%%%%##%%%%%%%@@@@@#*#%@@@@@@%*+===+****##%%%%##**##**+=----===+*#%%%#*+==+++++++======----------==-=*#==========++++++++++++++++##===--:::::::-==========-::------:-+%@%@@@@@
-----::::::::::::=@@@@@@@%%%%%%%%#%%%%%##*%@@#**#%@@@@@@@*=====+*############*++======+#%%@%%*+===========-====------------====-+#==========+++++++++++++++++==----:::--==========---==-:--==*#%@%%%@@@@@
:::::::::::::-----%@@@@@@@@%%%%%%%%@@@@@%%#%@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@@%%@%+++=++==============-=--------=====-+#==========**++++++++++++++===----=========+++=========+%@%%%%%%%%%@@@@@
::::::::::::-----=%@@@@@@@@@%%%%%%%@@@@%%%##%@%%@@%##*****+-=======++++++===---=#@@@@%%%%%@#+*+++++=============----------=-----+*==========*##===-=++++++++==--=========+++++++=====+%%%%%%%%%%%%%@@@@@@
%#+=-:::::-=+#%@@@@@@@@@@@@@@@%%@@@@@@@@%@@@@%%@@#*%%%#####=-=====------------=--*@%+----=*%#*%%#*+===============-===--===----=**==========*#*===++*##*+**+===========+++***++*****#%%%%%%%%%%%%%%%@@@@@
@@@@@@@%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%#*#@@@%*%%%#**##*=------=------=====--+%#-:----==#%+#%%#+======================-=-==**===========:=+=++####%%#**+=+++=--:----=+*****###%@%%%%%%%%%%%%%%%%%%@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%#%@%@@@@@#+###*####+------==------===---+%*------===+%#+#%%*+======================+**=============::=+*##%#####*+=---====----==+*******%%%%%%%%%%%%%%%%%%%%%@@@
@@@@@@@@@@@@@@@@@@@%@@@@@@@@@%@@@@@@@@%%##%@@@%%@@@#*####%%%#=------========----=*%+------=====*##+*##++++++=========++++**+==============+*=--::=++*##+--==---::--======-+****###%%%%%%%%%%%%%%%%%%%%%%%
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%@@@@@@@%##%@@@%@@@@@@#+*###%%#+-------===========+%%=-------=====+*%%*+*##*+++++++++***++================-=+##=---:::--------------=--:..:=+++**##%%%%%%%%%%%%%%%%%%%%%%%%
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%@@%%@@@%%#@@@@@@@@@@@@%+======-------===========+#@*---------=====+++**#****+*****++====================-==*@%#*=----:::---:----::....:-+*####%%####%%%%%%%%%%%%%%%%%%%%%%
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%@%@@@@@@@@@@@@@@@@@%*=------------=======+++#@#=---::-----====+=======++++++++++++***+=============--==+%@##**+---::----::..:::--=+++**####***###%%%%%%%%%%%%%%%%%%%%%
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%@@@%@@@@@@@@@@@@@@@%%#**=--------=====++*++*#*=-----:::------==+===-===+++++++++++**#**#+===========-====#@@#*****=::::::.........::::.........:::-=+**#%%%%%%%%%%%%%%%
@@@@@@@@@@@@@@%%%%@@@@@@@@@@@@@@@@@@@%@@@@@@@@@@@@@@@%#**+++++++++++++++++++++=-------::::-----=========++++==+++++++***+*+================*%%%%#**#+:::..........::::::::::..:.......................::-
@@@@@@@@@@@%%%%%%%@@%%%@@%@@@@@@@@@@@@@@@@@@@@@@@@@@%#*+===--::::-=--===+***++==-------:-------========++++++++++++*#*+++++===============+=+#####*#+::::::::::::::::::::::::::..........................
@@@@@@@@@@@%%%%%%%%@%%%%%%%##@@@@@@@@@@@@@@@@@@@@%*+=------------:----=++##*++==--------------======+*+++++++++==**++++++++===========++==+++%@@@%##*::::::::::::::::::::::..::::........................
@@@%@@@@%@@@%%%%%@@%%%%%#%%%#+*%@@@@@@@@@@@@%#*++++=====---------------=+*#*+*+===-----------====*#***+++++====+**++===+++==========+++++++++#@@@@##*::::::::::::::::::::::..:...........................
@%%@@%%%%@@@@%%%%%%%%%%%%%%%%%*#@@@@@@%#*+============------------------==++**+++====----======+*****+++=====+**+++====+++=========++++++++++*%@@@@%*:::::::::::::::::::::::::...........:...............
%%%%%%%@@@%@@@%%%%%%%####%%%%%%%%@@%*===============----------------------==+**++==-===--=====+++**+++=+==+***+++=====++==========+++++++++++*#%@@@@+:::::::::::::::::::::::::...::::::.:::..............
@@@%%%@@@%%@@@%%%%%%#######%%%%%%*++================---====----------:------=++++====-=====+++++++++==++*#*++++=======++=========++++++++++++*#%%@@@+::::::::::.:::::::::::::::::::::::::................
@@@%%@@%%@%@@@@%%%%%%%%###%%%%%%***++============--=======---------::------::-=+++=====-=++++++++++****+++++++=================+++++++++++++**#%%@@%=::::::::::::::::...:::::::::::::::::................
@%%@@@@%@@%%@@@%%%%%%%%%%%%%%@@%++++==========--------=======-----------=-::::--====--====+++++****++=++++++==================++++++++++++++**#%%@@#-::::::::::::::::::..:::::::::::::::.................
@@@@@%%%%%%%@@@%%##%%%%%%%@%%#+++++==========------=++==---------------:::::---=+====---=======++++++++++++================++++++++++++++++**##%%%%+::::::::::::::::.::::.:::::::::::::::................
@%%%%%%%%%%%@@@@%%%%%%%#*+===+==============---======--------::...........::--=**+====----=====++++++++++==============+++++++++++++++++++***##%%%#-:::::::::::::::::.::::::..:::::::::::::..............
@@@@@@@@@@@@@@@@@@@@#+====--===================-----------:..............::::-+****+====---======++++++++++============+++**+++++++++++++****##%%%=-::::::::::::::::::::::..:::::::::::::::..............
@@@@@@@@@@@@@@@@@@*==+++=---=#*+++++=++====-==========-:...............::::::=+++**#*===========+++++++================++**++++++++++++++****####*-:::::::::::::::::::::..::::::::::::::::..:............
@@@@@@@@@@@@@@@#==++*+==----+=----===============---:.................:::.:::-*+=+*%%*==--=============================+*+++++++++++++++*****###*--::::::::::::::::::::.::::::::::::::::::::.............
@@@@@@@@@@@@%+--=*#*==-----==--------------------:.....................::::::-++==*%%%*=---==========================+**+++++++++++++++******##*=--::::::::::::::::::.:::::::::::::::::::::..............
@@@@@@@@@@%+---=*#+==------==-----------------:.........................::::::=*++#%%%##+--========================++*++++++++++++++++********#+--:::::::::::::::::::::::::::::::::::::::::..............
@@@@@@@@#=----=+*+==------===-------------::.............................:::::-**+*%@%##**======================+=+++++++++++++++++++*********+--:::::::::::::::::::::::::::::::::::::::::..............:
@@@@@@#-------=====-------=-----------::..................................:::::=#**%@%###**+===================++++++++++++++++++++++********+-:::::::::::::::::::::::::::::::::::::::::::............:::
@@@@@#--------------------=--------:......................................::::::+#*#@%##***+++++======+++++++++++++++++++++++++++++++****+*+==-:-:::::::::::::::::::::::::::::::::::::::..............:::
@@@@%=---------------------------:.........................................::::::=*#@%##****+++==+=====++++++++++++++++++=+==++++++++**+++==---=---:::::::::::::::::::::::::::::::::::::............:::::
@@@%---------------------===---:...........................................:::::::=*%%###****++++=++=====++==++++++++========+++++++**+++=----=--:::::--::::::::::::::::::::::::::::::::.........::::::::
@@@=---------------------==--:..............................................:::::::-=#%###****+++++++++++++++++++++======++++++++++*+++=-::----::::::--:::::::::::::::::::::::::::::::::........:.:::::::
@@%----------------------==-:..........................................::.:.::::::::--+###*****++++++++++++++++++++++===++++++==++++=-::::----::--:--:::::::::::::::::::::::::::::::::::........:::::::::
@@#-----------------------:..........................................::::::::::::::::-=+*##***+++++++++++++++++++++=====+++++===+++-:::::----::----:::::::::::::::::::::::::::::::::::::.::..:.:::::::::.
@@*---------------------:..............................:::.::::........:::::::::::::::-++++******+++++++++++++++++++===++=+=======-:::::-----::::::::::::::::::::::::::::::::::::::::::::::..:::::::::::.
@@+-------------------:..................................:.::::::::.:::::::::::::::::::-=+++++****++++++++++++++++=========---====::::-------:::::::::::::::::::::::::::::::::::::::::::..:.:::::::::.:::
@@+------------------:..........................:.....:::::..:::::::::::::::::::::::.::::-=+++++++++++++++++==========-------==-:::------:::::::::::::::::::::::::::::::::::::::::::::::..::::::::::::.::
@%=-----------------:.......................::............::::::::::::::::::::::::::::::::-=+++=++++*+++++++++=======---------::---:---::::::::::::::::::::::::::::::::::::::::::::::.:::.::::::::::::...
@#-------------===-:.....................::::.................:::::::::::::::::::::::::----:-====++++*-:::--==++======-------:::-:::-:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::.
@*-------------==-....................::::::::::::...............::::::::::::::::::::::::::::::--===+=+=--:--------=====---:::-:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::...
@+-----------===-.....:..................:::::::::::...............::::::::::::::::::::::::::::::-=---==*%%%%%######*++==-:::::::::::::-:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::..
%=-----------==-:.....:............::.....:.:::..:::::::.............:::::::::::::::::::::::::::::-----::::::::::---=+*#+:::-::::::--:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::.
#-------------=:......::............::...:..::...::::::::.:...........::::::::::::::::::::::::::::::::::::::::::::::::--::-::::::::-::::::::-:::::::::::::::::::::::::::::::::::::::::::::::::::::::::...
+-------------:.......:::..::::....:::::...:::.....:::::::::::......:::::::::::::::::::::::::::::::::::::::::::::::::::::---:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::....
+------------:.......:::..:....::..:::::::::::....::::..:::::::::::...:::::::::::::::::::::::::::::::::::::::::::::::::::::-:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
+-----------:........:::..:.........:::::::::.:....:::.:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::..:::
#-----------:........:::.:....:.....:::::::::.....:::::.::.:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::..:::
#----------:.........:::::...:::.....:::::::::::..:::::..:....:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::.:::.:::::
*---------:..........:::::..:.::::::..::::::::::..:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
=---------:.........:::::::...::::..::.::::.:::::....:....:.::::::.::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::.:::
=----====-:.........:::::::...::::::...:::::::::::..::.:::..::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::..::.::::
"""
